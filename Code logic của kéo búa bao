import random

class RockPaperScissorsGame:
    def __init__(self):
        self.choices = {1: "Kéo", 2: "Búa", 3: "Bao"}
        self.player_score = 0
        self.computer_score = 0
        self.total_games = 0
    
    def get_computer_choice(self):
        return random.randint(1, 3)
    
    def determine_winner(self, player_choice, computer_choice):
        if player_choice == computer_choice:
            return "Hòa"
        
        if (player_choice == 1 and computer_choice == 3) or \
           (player_choice == 2 and computer_choice == 1) or \
           (player_choice == 3 and computer_choice == 2):
            return "Player"
        
        return "Computer"
    
    def play_round(self, player_choice):
        if player_choice not in [1, 2, 3]:
            return None
        
        computer_choice = self.get_computer_choice()
        winner = self.determine_winner(player_choice, computer_choice)
        
        if winner == "Player":
            self.player_score += 1
        elif winner == "Computer":
            self.computer_score += 1
        
        self.total_games += 1
        
        return {
            'player_choice': self.choices[player_choice],
            'computer_choice': self.choices[computer_choice],
            'winner': winner,
            'player_score': self.player_score,
            'computer_score': self.computer_score,
            'total_games': self.total_games
        }
    
    def reset_game(self):
        self.player_score = 0
        self.computer_score = 0
        self.total_games = 0
    
    def get_game_stats(self):
        if self.total_games == 0:
            return "Chưa chơi ván nào!"
        
        win_rate = (self.player_score / self.total_games) * 100
        draws = self.total_games - self.player_score - self.computer_score
        return f"Tổng: {self.total_games} | Thắng: {self.player_score} | Thua: {self.computer_score} | Hòa: {draws} | Tỷ lệ: {win_rate:.1f}%"

if __name__ == "__main__":
    game = RockPaperScissorsGame()
    print("1=Kéo, 2=Búa, 3=Bao, 0=Thoát")
    
    while True:
        try:
            choice = input("Chọn (1-3): ")
            if choice == '0':
                print(game.get_game_stats())
                break
            
            result = game.play_round(int(choice))
            if result:
                print(f"Bạn: {result['player_choice']} | Máy: {result['computer_choice']}")
                print(f"Kết quả: {result['winner']} | Tỷ số: {result['player_score']}-{result['computer_score']}")
        except:
            print("Nhập lại!")
